# 🗂️ Podcast Pipeline — 项目规划器

> 最后更新: 2026-02-20
> 状态图例: ✅ 完成 | 🔄 进行中 | ⏳ 待开始 | 🚫 阻塞

---

## 总览

| 支线 | 进度 | 下一步 |
|------|------|--------|
| Data Pipeline | 🔄 30% | P0: 存量回填 |
| 知识库构建 | ⏳ 0% | 等待转录完成 |
| 播客生成 | 🔄 60% | 等待知识库 + 自动化 |

---

## 支线一：Data Pipeline

### P0 — 数据获取与转录（最高优先级）

| ID | 任务 | 状态 | 依赖 | 负责 | 备注 |
|----|------|------|------|------|------|
| D-001 | RSS feed 接入 | ✅ | - | Luna | `https://feed.xyzfm.space/y9qnpfdrctnx` 289集 |
| D-002 | 每日增量检查 (GHA) | ✅ | D-001 | Luna | `check-new-episodes.yml` |
| D-003 | 过滤规则实现 | ✅ | D-001 | Luna | `src/ingest/filter.py` 基础版已有 |
| D-004 | 过滤规则扩展 | ⏳ | D-003 | Luna | 加对谈/付费/特别节目过滤 |
| D-005 | 存量回填 workflow | ⏳ | D-001, D-004 | Luna | `backfill.yml` 分批下载 289 集 |
| D-006 | Whisper 转录 | ✅ | - | Luna | `modal_whisper.py` 已验证 |
| D-007 | 存量全量转录 | ⏳ | D-005 | Luna | 预计 ~50 GPU 小时 |
| D-008 | HF Dataset 同步 | ✅ | - | Luna | `sync-hf.yml` + `sync_hf.py` |
| D-009 | CodeRabbit + 自动合并 | ✅ | - | Luna | `luna-review.yml` |

### P1 — 数据处理

| ID | 任务 | 状态 | 依赖 | 负责 | 备注 |
|----|------|------|------|------|------|
| D-010 | LLM 校对模块 | ⏳ | D-007 | Luna | `src/proofread/correct.py` |
| D-011 | 校对 prompt 设计 | ⏳ | D-010 | Luna | 哲学术语/人名/书名修正 |
| D-012 | 全量校对执行 | ⏳ | D-011 | Luna | 预计 ~$5 API 成本 |
| D-013 | 音频切片模块 | ✅ | - | Luna | webrtcvad 已验证 (1992 段) |
| D-014 | 质量分析模块 | ✅ | D-013 | Luna | SNR/频谱分析已验证 |
| D-015 | 参考音频筛选 | ✅ | D-014 | Luna | Top 50 已选出 |
| D-016 | 全量音频切片 | ⏳ | D-005 | Luna | 对 289 集全部执行切片 |
| D-017 | 全量质量分析 + 筛选 | ⏳ | D-016 | Luna | 更新参考音频池 |

### P1 — 风格档案

| ID | 任务 | 状态 | 依赖 | 负责 | 备注 |
|----|------|------|------|------|------|
| D-018 | 风格分析（15集） | ✅ | - | Luna | `style-guide.md` 已完成 |
| D-019 | 风格分析扩展（全量） | ⏳ | D-012 | Luna | 基于校对后全量文本 |
| D-020 | 风格档案结构化 | ⏳ | D-019 | Luna | JSON 格式，供 LLM prompt 使用 |

---

## 支线二：知识库构建

### P2 — 实体提取与知识库

| ID | 任务 | 状态 | 依赖 | 负责 | 备注 |
|----|------|------|------|------|------|
| K-001 | 实体提取模块 | ⏳ | D-012 | Luna | `src/knowledge/extract.py` |
| K-002 | 实体类型定义 | ⏳ | - | Carl | 哲学家/书名/概念/事件/引用关系 |
| K-003 | 全量实体提取 | ⏳ | K-001, D-012 | Luna | 从校对后文本提取 |
| K-004 | 网络搜索补充 | ⏳ | K-003 | Luna | 维基百科/学术资源 |
| K-005 | 结构化实体库 | ⏳ | K-004 | Luna | JSON/SQLite |
| K-006 | 文本切片 (RAG) | ⏳ | D-012 | Luna | 500-1000字/chunk |
| K-007 | Embedding 生成 | ⏳ | K-006 | Luna | bge-m3 |
| K-008 | FAISS 向量库构建 | ⏳ | K-007 | Luna | 本地存储 |
| K-009 | 检索接口实现 | ⏳ | K-005, K-008 | Luna | 双层检索：精确+语义 |
| K-010 | 检索效果验证 | ⏳ | K-009 | Carl | 人工评估 top-k 相关性 |

---

## 支线三：播客生成

### P3 — 自动化生成

| ID | 任务 | 状态 | 依赖 | 负责 | 备注 |
|----|------|------|------|------|------|
| G-001 | 脚本生成 prompt | 🔄 | D-020 | Luna | 已有基础版，需接入风格档案 |
| G-002 | RAG 集成 | ⏳ | K-009, G-001 | Luna | 检索知识库 → 注入 context |
| G-003 | 脚本分句模块 | ✅ | - | Luna | 已验证 |
| G-004 | IndexTTS-2 推理 | ✅ | - | Luna | V8 配置已锁定 |
| G-005 | 参考音频智能匹配 | 🔄 | D-017 | Luna | 基础轮换已实现，语义匹配待做 |
| G-006 | 音频拼接 | ✅ | - | Luna | ffmpeg concat |
| G-007 | 一键生成脚本 | ⏳ | G-002, G-004 | Luna | `scripts/generate_episode.py` |
| G-008 | 后期处理 | ⏳ | G-006 | Luna | 音量归一化、背景音乐(可选) |
| G-009 | 生成质量评估 | ⏳ | G-007 | Carl | 人工试听 + 评分 |

---

## 里程碑

| 里程碑 | 目标日期 | 依赖任务 | 状态 |
|--------|----------|----------|------|
| M1: 全量数据入库 | 2026-02-27 | D-005, D-007, D-008 | ⏳ |
| M2: 校对完成 | 2026-03-03 | D-012 | ⏳ |
| M3: 知识库 v1 | 2026-03-10 | K-008, K-009 | ⏳ |
| M4: 端到端自动生成 | 2026-03-15 | G-007 | ⏳ |
| M5: 质量达标 | 2026-03-20 | G-009 | ⏳ |

---

## 依赖关系图

```
D-001 (RSS) ──→ D-004 (过滤扩展) ──→ D-005 (存量回填) ──→ D-007 (全量转录)
                                                              │
                                                              ▼
                                                         D-012 (全量校对)
                                                              │
                                    ┌─────────────────────────┼──────────────────┐
                                    ▼                         ▼                  ▼
                              D-016 (全量切片)          K-001 (实体提取)    D-019 (风格扩展)
                                    │                         │                  │
                                    ▼                         ▼                  ▼
                              D-017 (质量分析)          K-005 (实体库)     D-020 (风格结构化)
                                    │                    K-008 (向量库)          │
                                    │                         │                  │
                                    ▼                         ▼                  ▼
                              G-005 (音频匹配)    ──→   K-009 (检索接口)   G-001 (脚本prompt)
                                    │                         │                  │
                                    │                         ▼                  │
                                    │                   G-002 (RAG集成) ←────────┘
                                    │                         │
                                    ▼                         ▼
                              G-004 (TTS) ←──────────── G-007 (一键生成)
                                    │
                                    ▼
                              G-006 (拼接) ──→ G-008 (后期) ──→ G-009 (评估)
```

---

## 资源预估

| 资源 | 用途 | 预估成本 |
|------|------|----------|
| Modal GPU (A10G) | Whisper 转录 289 集 | ~$25-50 |
| Modal GPU (A10G) | IndexTTS-2 合成 | ~$2/集 |
| LLM API | 校对 + 实体提取 + 脚本生成 | ~$10-20 |
| HuggingFace | 存储 | 免费 |
| GitHub Actions | CI/CD | 免费 (公开 repo) |
| **总计** | | **~$50-100 启动** |

---

## 变更日志

| 日期 | 变更 |
|------|------|
| 2026-02-20 | 初始版本，基于 PLAN.md 创建 |
